!function(e){e.fn.autoComplete=function(t){var i=e.extend({},e.fn.autoComplete.defaults,t);return"string"==typeof t?(this.each(function(){var i=e(this);"destroy"==t&&(e(window).off("resize.autocomplete",i.updateSC),i.off("blur.autocomplete focus.autocomplete keydown.autocomplete keyup.autocomplete"),i.data("autocomplete")?i.attr("autocomplete",i.data("autocomplete")):i.removeAttr("autocomplete"),e(i.data("sc")).remove(),i.removeData("sc").removeData("autocomplete"))}),this):this.each(function(){function a(e){var a=t.val();if(t.cache[a]=e,e.length&&a.length>=i.minChars){for(var n="",r=0;r<e.length;r++)n+=i.renderItem(e[r],a);t.sc.html(n),t.updateSC(0)}else t.sc.hide()}var t=e(this);t.sc=e('<div class="autocomplete-suggestions '+i.menuClass+'"></div>'),t.data("sc",t.sc).data("autocomplete",t.attr("autocomplete")),t.attr("autocomplete","off"),t.cache={},t.last_val="",t.updateSC=function(i,a){if(t.sc.css({top:t.offset().top+t.outerHeight(),left:t.offset().left,width:t.outerWidth()}),!i&&(t.sc.show(),t.sc.maxHeight||(t.sc.maxHeight=parseInt(t.sc.css("max-height"))),t.sc.suggestionHeight||(t.sc.suggestionHeight=e(".autocomplete-suggestion",t.sc).first().outerHeight()),t.sc.suggestionHeight))if(a){var n=t.sc.scrollTop(),r=a.offset().top-t.sc.offset().top;r+t.sc.suggestionHeight-t.sc.maxHeight>0?t.sc.scrollTop(r+t.sc.suggestionHeight+n-t.sc.maxHeight):0>r&&t.sc.scrollTop(r+n)}else t.sc.scrollTop(0)},e(window).on("resize.autocomplete",t.updateSC),t.sc.appendTo("body"),t.sc.on("mouseleave",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected")}),t.sc.on("mouseenter",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected"),e(this).addClass("selected")}),t.sc.on("mousedown click",".autocomplete-suggestion",function(a){var n=e(this),r=n.data("val");return(r||n.hasClass("autocomplete-suggestion"))&&(t.val(r),i.onSelect(a,r,n),t.sc.hide()),!1}),t.on("blur.autocomplete",function(){try{over_sb=e(".autocomplete-suggestions:hover").length}catch(i){over_sb=0}over_sb?t.is(":focus")||setTimeout(function(){t.focus()},20):(t.last_val=t.val(),t.sc.hide(),setTimeout(function(){t.sc.hide()},350))}),i.minChars||t.on("focus.autocomplete",function(){t.last_val="\n",t.trigger("keyup.autocomplete")}),t.on("keydown.autocomplete",function(a){if((40==a.which||38==a.which)&&t.sc.html()){var n,r=e(".autocomplete-suggestion.selected",t.sc);return r.length?(n=40==a.which?r.next(".autocomplete-suggestion"):r.prev(".autocomplete-suggestion"),n.length?(r.removeClass("selected"),t.val(n.addClass("selected").data("val"))):(r.removeClass("selected"),t.val(t.last_val),n=0)):(n=40==a.which?e(".autocomplete-suggestion",t.sc).first():e(".autocomplete-suggestion",t.sc).last(),t.val(n.addClass("selected").data("val"))),t.updateSC(0,n),!1}if(27==a.which)t.val(t.last_val).sc.hide();else if(13==a.which||9==a.which){var r=e(".autocomplete-suggestion.selected",t.sc);r.length&&t.sc.is(":visible")&&(i.onSelect(a,r.data("val"),r),setTimeout(function(){t.sc.hide()},20))}}),t.on("keyup.autocomplete",function(n){if(!~e.inArray(n.which,[13,27,35,36,37,38,39,40])){var r=t.val();if(r.length>=i.minChars){if(r!=t.last_val){if(t.last_val=r,clearTimeout(t.timer),i.cache){if(r in t.cache)return void a(t.cache[r]);for(var o=1;o<r.length-i.minChars;o++){var s=r.slice(0,r.length-o);if(s in t.cache&&!t.cache[s].length)return void a([])}}t.timer=setTimeout(function(){i.source(r,a)},i.delay)}}else t.last_val=r,t.sc.hide()}})})},e.fn.autoComplete.defaults={source:0,minChars:3,delay:150,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var i=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(i,"<b>$1</b>")+"</div>"},onSelect:function(){}}}(jQuery);
