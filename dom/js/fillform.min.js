function finishWizard(e){var t=$(".wizard-content"),a=$(".wizard-menu .list-group-item"),n=$(".wizard-content form");$(document.body).on("click",".wizard-fin",function(i){var d=$(this);i.preventDefault();var l=parseInt($(this).attr("data-current-step")),s=($(".step-"+(l+1)),$(".step-"+(l+1)+"-menu")),o=$(".step-"+l+"-menu"),u=$(".step-"+l);a.removeClass("active"),s.addClass("active"),d.html('<img src="http://upload.wikimedia.org/wikipedia/commons/4/42/Loading.gif"> Пожалуйста подождите...'),d.addClass("disabled");var c=n.attr("data-method"),m=n.attr("data-action");$.ajax({url:m,type:c,data:n.serialize(),success:function(){t.prepend('<div class="alert alert-success">Отправка...<strong> Подождите...</strong></div>'),o.addClass("success"),d.html("Конец"),d.removeClass("disabled"),window.setTimeout(function(){$(".alert").hide(),e()},5e3)},error:function(){t.prepend('<div class="alert alert-danger"><strong>Ошибка!</strong> Пожалуйста, попробуйте заново.</div>'),o.addClass("error"),window.setTimeout(function(){var e=u.attr("data-load");$(".alert").hide(),o.removeClass("error"),o.addClass("active"),d.html("Конец"),d.removeClass("disabled"),"undefined"!=typeof e&&e!==!1?t.load(e):t.html(l.html())},2e3)}})})}function nextStep(){var e=$(".wizard-content"),t=$(".wizard-menu .list-group-item"),a=$(".wizard-content form");$(document.body).on("click",".wizard-next",function(n){var i=$(this);n.preventDefault();var d=parseInt($(this).attr("data-current-step")),l=$(".step-"+(d+1)),r=$(".step-"+(d+1)+"-menu"),s=$(".step-"+d+"-menu"),o=$(".step-"+d);t.removeClass("active"),r.addClass("active"),i.html('<img src="http://upload.wikimedia.org/wikipedia/commons/4/42/Loading.gif"> Подождите...'),i.addClass("disabled");var u=a.attr("data-method"),c=a.attr("data-action");$.ajax({url:c,type:u,data:a.serialize(),success:function(){s.addClass("success"),i.html("Далее"),i.removeClass("disabled"),window.setTimeout(function(){var t=o.attr("data-load");$(".alert").hide(),"undefined"!=typeof t&&t!==!1?e.load(t):e.html(l.html())},500)},error:function(){e.prepend('<div class="alert alert-danger"><strong>Ошибка!</strong>Пожалуйста, попробуйте заново.</div>'),s.addClass("error"),window.setTimeout(function(){var t=o.attr("data-load");$(".alert").hide(),s.removeClass("error"),s.addClass("active"),i.html("Далее"),i.removeClass("disabled"),"undefined"!=typeof t&&t!==!1?e.load(t):e.html(d.html())},2e3)}})})}function changeSteps(){var e=$(".wizard-content"),t=$(".wizard-menu .list-group-item");$(document.body).on("click",".wizard-prev",function(a){a.preventDefault();var n=parseInt($(this).attr("data-current-step")),i=$(".step-"+(n-1)),d=$(".step-"+(n-1)+"-menu");t.removeClass("active"),d.addClass("active"),d.removeClass("success");var l=i.attr("data-load");"undefined"!=typeof l&&l!==!1?e.load(l):e.html(i.html())})}function loadDataOnReady(){var e=$(".wizard-content"),t=$(".wizard-menu .list-group-item.active").attr("data-for"),a=$(t),n=a.attr("data-load");"undefined"!=typeof n&&n!==!1?e.load(n):e.html(a.html())}function loadDataOnClick(){var e=$(".wizard-menu .list-group-item"),t=$(".wizard-content");e.on("click",function(a){a.preventDefault(),e.removeClass("active"),$(this).addClass("active");var n=$(this).attr("data-for"),i=$(n),d=i.attr("data-load");"undefined"!=typeof d&&d!==!1?t.load(d):t.html(i.html())})}function otherField(){$.viewInput={0:$([]),otherField:$("#otherField")},$("#otherFieldOption").change(function(){$.each($.viewInput,function(){this.hide()}),$.viewInput[$(this).val()].show()})}function validation(){function s(){document.getElementById("error").style.display="inline-block",setTimeout(function(){document.getElementById("error").style.display="none"},3e3)}$("#email").on("input",function(){var e=$(this),t=document.getElementById("emailError"),a=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,n=a.test(e.val());n?e.removeClass("invalid").addClass("valid"):(e.removeClass("valid").addClass("invalid"),t.style.display="inline-block",setTimeout(function(){t.style.display="none"},3e3))});var e=document.getElementById("name"),t=document.getElementById("email"),a=document.getElementById("birthday"),n=document.getElementById("birthplace"),i=document.getElementById("number"),d=document.getElementById("main_address"),l=document.getElementById("living_address"),r=function(){return""==e.value||""==t.value||""==a.value||""==n.value||""==i.value||""==d.value||""==l.value?1:0};$(".fillBtn").click(function(){1==r()?(document.getElementById("fill-button").disabled=!0,document.getElementById("emailError").style.display="none",s(),setTimeout(function(){document.getElementById("fill-button").disabled=!1},3e3)):document.getElementById("fill-button").disabled=!1});var o=document.getElementById("fileUp");null!=o&&(o.onchange=function(){this.files[0].size>2097152?(document.getElementById("fileError").style.display="inline-block",document.getElementById("fileSend").disabled=!0,setTimeout(function(){document.getElementById("fileError").style.display="none"},3e3),this.value=""):document.getElementById("fileSend").disabled=!1})}$(document).ready(function(){loadDataOnReady(),loadDataOnClick(),changeSteps(),nextStep(),otherField(),validation(),finishWizard(function(){})});